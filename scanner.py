import requests,time,re,random,os,sys
from random import sample
from multiprocessing.dummy import Pool as ThreadPool
from colorama import Fore,Style, init
import subprocess
import warnings
from requests.packages.urllib3.exceptions import InsecureRequestWarning
warnings.simplefilter('ignore',InsecureRequestWarning)
reload(sys)  
sys.setdefaultencoding('utf8')
init(autoreset=True)


r = Fore.RED + Style.BRIGHT
g = Fore.GREEN + Style.BRIGHT
c = Fore.CYAN + Style.BRIGHT
y = Fore.YELLOW + Style.BRIGHT
o = Fore.RESET + Style.RESET_ALL

def version_check(url):
	try:
		headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3'}
		response = requests.get('http://'+url+ '/wp-content/plugins/royal-elementor-addons/readme.txt', headers=headers, timeout=10)
		
		if response.status_code == 200:
			content = response.text
			version_line = next((line for line in content.split('\n') if line.startswith('Stable tag:')), None)
			if version_line:
				version = version_line.split(':')[1].strip()
				if version <= '1.3.70':
					print("\033[92m{} > [Plugin VULN]\033[0m".format(url))  # Green color
					with open("vuln.txt", "a") as vuln_file:
						vuln_file.write(url + "\n")
				else:
					print('Shin')
			else:
				print('shin')
		else:
			print('Shin')
	except Exception as e:
		print(e)
		pass
if __name__ == '__main__':
	os.system('cls' if os.name == 'nt' else 'clear')
	print "{} 00Shinday00  | {}Shin Code\n".format(y,c)
	url = open(raw_input('List:~# '),'r').read().replace('http://','').replace('https://','').splitlines()
	pool = ThreadPool(int(20))
	pool.map(version_check, url)
	pool.close()
	pool.join()


